{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "26d2fea7-3646-4993-b79f-6722f9ef8ddb",
            "version": "KqlParameterItem/1.0",
            "name": "DefaultSubscription_Internal",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\n| take 1\n| project subscriptionId",
            "crossComponentResources": [
              "value::selected"
            ],
            "isHiddenWhenLocked": true,
            "timeContextFromParameter": "TimeRange",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "55d3ab63-6e1f-4d02-8d9e-2225526689c7",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "query": "summarize by subscriptionId\n| project value = strcat(\"/subscriptions/\", subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ '{DefaultSubscription_Internal}', true, false)",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "95a45501-31b5-4ea2-bcb3-eb208e0080e2",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "query": "where type =~ \"microsoft.operationalinsights/workspaces\"\r\n| where '{Subscription}' has subscriptionId",
            "crossComponentResources": [
              "value::all"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "7d597ad7-4a2a-45ed-a4fe-7ee32de0fc22",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Time Range",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 26697600000,
              "endTime": "2022-01-05T13:29:00.000Z"
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                }
              ],
              "allowCustom": true
            }
          },
          {
            "id": "9a199167-2dde-49dd-8f01-23e9d1fa8151",
            "version": "KqlParameterItem/1.0",
            "name": "InternalRG",
            "type": 1,
            "isRequired": true,
            "query": "where type =~ \"microsoft.operationalinsights/workspaces\"\r\n| where id =~  \"{Workspace}\"\r\n| project resourceGroup",
            "crossComponentResources": [
              "{Workspace}"
            ],
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "c4470c37-5a8a-4ecd-8ece-5e98db8e8a92",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "Show Help",
            "type": 10,
            "description": "This will show some help information to help you understand the page you are on",
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[{ \"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }]",
            "value": "Yes"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "100",
      "name": "WSSelector"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "# Overview\r\n###### In this workbook you will be able to see all the tables that are receiving logs for the time range you have selected above. \r\n###### Once you select one table, you will see how it is being used by the different Microsoft Sentinel features, like analytics, hunting queries, playbooks and queries in general."
            },
            "name": "IntroductionText"
          },
          {
            "type": 1,
            "content": {
              "json": "Once you have selected the desired parameters above, you will see tables with ingestion activity over the selected time range.\r\nAfter selecting a table, you can see relevant information in tabs right below:\r\n- The Analytics tab shows which analytics templates and rules are available, enabled or disabled in {Workspace:label}\r\n- The Saved searches and hunting tab shows saved searches, hunting queries and also bookmarks saved for the selected table under {Workspace:label} \r\n- The Searches and queries tab contains information about the number of searchs and queries run against the {Workspace:label}, and where these searches originated\r\n",
              "style": "info"
            },
            "conditionalVisibility": {
              "parameterName": "Help",
              "comparison": "isEqualTo",
              "value": "Yes"
            },
            "name": "HelpNote"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Usage\r\n| where DataType !contains '_srch'\r\n| distinct DataType\r\n",
              "size": 0,
              "title": "Tables with ingestion in the {TimeRange:label} ",
              "noDataMessage": "No tables were used in this period",
              "timeContext": {
                "durationMs": 26697600000
              },
              "timeContextFromParameter": "TimeRange",
              "exportFieldName": "DataType",
              "exportParameterName": "TableName",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "filter": true,
                "sortBy": [
                  {
                    "itemKey": "DataType",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "DataType",
                    "label": " "
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "DataType",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "33",
            "name": "TablesUsage"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": " let TNameTable = datatable (NameOfTable: string) ['{TableName}'];\r\n TNameTable",
              "size": 0,
              "title": "Table with only TableName as content",
              "timeContext": {
                "durationMs": 86400000
              },
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibility": {
              "parameterName": "0",
              "comparison": "isEqualTo",
              "value": "0"
            },
            "name": "CreationOfTableName"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "020e50e2-cc1c-491f-9e28-aecdbc0fdba2",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Analytics",
                  "subTarget": "analytics",
                  "preText": "Analytics",
                  "style": "link"
                },
                {
                  "id": "38de0079-5552-4eda-8655-c927e052363a",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Saved searches and Hunting queries",
                  "subTarget": "hunting",
                  "style": "link"
                },
                {
                  "id": "fcdb8707-248f-484f-8886-24e4ae9ffd81",
                  "cellValue": "selectedTab",
                  "linkTarget": "parameter",
                  "linkLabel": "Searches and queries",
                  "subTarget": "searches",
                  "style": "link"
                }
              ]
            },
            "name": "links - 8"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Summary of analytic rules for the {TableName} table",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRules\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-10-01-preview\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.description\",\"columnid\":\"Description\"},{\"path\":\"$.properties.enabled\",\"columnid\":\"Enabled\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.tactics\",\"columnid\":\"Tactics\"},{\"path\":\"$.properties.severity\",\"columnid\":\"Severity\"},{\"path\":\"$.properties.queryPeriod\",\"columnid\":\"QueryPeriod\"},{\"path\":\"$.properties.queryFrequency\",\"columnid\":\"QueryFrequency\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*{TableName}[\\\\s\\\\S]*\",\"substringReplace\":\"{TableName}\"},{\"path\":\"$.properties.alertRuleTemplateName\",\"columnid\":\"TemplateID\"},{\"path\":\"$.properties.lastModifiedUtc\",\"columnid\":\"LastModifiedOn\"}]}}]}",
                    "size": 0,
                    "title": "All Analytic rules",
                    "noDataMessage": "No analytic rules are defined ",
                    "exportParameterName": "TestQ",
                    "exportToExcelOptions": "all",
                    "queryType": 12,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RuleName",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Description",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5,
                          "formatOptions": {
                            "customColumnWidthSetting": "0ch"
                          }
                        }
                      ],
                      "rowLimit": 512,
                      "labelSettings": [
                        {
                          "columnId": "RuleName",
                          "label": "Rule name"
                        }
                      ]
                    },
                    "sortBy": [],
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "0",
                    "comparison": "isEqualTo",
                    "value": "0"
                  },
                  "name": "All Analytic rules"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "Below you can see two graphs. The first one shows how many analytics rules are enabled and disabled. In the second graph you can see the severity of all the analytic rules (both enabled and disabled)",
                          "style": "info"
                        },
                        "conditionalVisibility": {
                          "parameterName": "Help",
                          "comparison": "isEqualTo",
                          "value": "Yes"
                        },
                        "name": "HelpText"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[All Analytic rules].Enabled\",\"mergedName\":\"Enabled\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Static 1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Enabled\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"1\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[Added column]\",\"mergedName\":\"Enabled or Disabled\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Enabled\",\"operator\":\"==\",\"rightValType\":\"static\",\"rightVal\":\"true\",\"resultValType\":\"static\",\"resultVal\":\"enabled\"}},{\"criteriaContext\":{\"leftOperand\":\"Enabled\",\"operator\":\"!=\",\"rightValType\":\"static\",\"rightVal\":\"true\",\"resultValType\":\"static\",\"resultVal\":\"disabled\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[All Analytic rules].TemplateID\",\"mergedName\":\"TemplateID\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"},{\"originalName\":\"[All Analytic rules].RuleName\"},{\"originalName\":\"[All Analytic rules].Description\"},{\"originalName\":\"[All Analytic rules].Query\"},{\"originalName\":\"[All Analytic rules].Tactics\"},{\"originalName\":\"[All Analytic rules].Severity\"},{\"originalName\":\"[All Analytic rules].QueryPeriod\"},{\"originalName\":\"[All Analytic rules].QueryFrequency\"},{\"originalName\":\"[All Analytic rules].TableUsed\"}]}",
                          "size": 0,
                          "title": "{TableName}: Enabled vs Disabled rules",
                          "noDataMessage": "Currently there are no rules which use this table",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "categoricalbar",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Table Name ",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "GenericDetails",
                                  "linkLabel": "Click to open query and view additional information",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "Query Period",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query Frequency",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "Enabled",
                                "label": "Status",
                                "comment": ""
                              }
                            ]
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Enabled",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Static 1",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "Enabled or Disabled",
                            "seriesLabelSettings": [
                              {
                                "seriesName": "enabled",
                                "color": "green"
                              },
                              {
                                "seriesName": "disabled",
                                "color": "gray"
                              }
                            ],
                            "xSettings": {
                              "numberFormatSettings": {
                                "unit": 0,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "25",
                        "name": "RulesWithTable - Chart - Enabled vs Disabled",
                        "styleSettings": {
                          "maxWidth": "25"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[All Analytic rules].Severity\",\"mergedName\":\"Severity\",\"fromId\":\"unknown\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Static 1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Severity\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"1\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[All Analytic rules].TemplateID\",\"mergedName\":\"TemplateID\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].Test\"},{\"originalName\":\"[All Analytic rules].EventIDEquals\"},{\"originalName\":\"[All Analytic rules].EventIDList\"},{\"originalName\":\"[All Analytic rules].test\"},{\"originalName\":\"[All Analytic rules].TableUsed\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"},{\"originalName\":\"[All Analytic rules].RuleName\"},{\"originalName\":\"[All Analytic rules].Description\"},{\"originalName\":\"[All Analytic rules].Enabled\"},{\"originalName\":\"[All Analytic rules].Query\"},{\"originalName\":\"[All Analytic rules].QueryPeriod\"},{\"originalName\":\"[All Analytic rules].QueryFrequency\"},{\"originalName\":\"[All Analytic rules].Tactics\"}]}",
                          "size": 0,
                          "title": "{TableName}: Severity of all the rules (enabled and disabled)",
                          "noDataMessage": "Currently there are no rules which use this table",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "categoricalbar",
                          "gridSettings": {
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Table Name ",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Static value 1",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "Severity",
                            "yAxis": [
                              "Static 1"
                            ],
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "High",
                                "color": "orange"
                              },
                              {
                                "seriesName": "Low",
                                "color": "yellow"
                              }
                            ]
                          }
                        },
                        "customWidth": "25",
                        "name": "RulesWithTable - Severity - Chart",
                        "styleSettings": {
                          "maxWidth": "25"
                        }
                      }
                    ]
                  },
                  "name": "Charts for rules"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Below, you can see all the enabled or disabled analytics rules that include the {TableName} table.\r\nPlease note that templates that have not been created will not show up here. ",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "Help",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "HelpText"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"Table Name \",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].RuleName\",\"mergedName\":\"Rule name\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].Description\",\"mergedName\":\"Description\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].Enabled\",\"mergedName\":\"Enabled\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].Severity\",\"mergedName\":\"Severity\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].Query\",\"mergedName\":\"Query\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].QueryPeriod\",\"mergedName\":\"Query Period\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].QueryFrequency\",\"mergedName\":\"Query Frequency\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].Tactics\",\"mergedName\":\"Tactics\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules].Version\",\"mergedName\":\"Version\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].TemplateID\",\"mergedName\":\"TemplateID\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules].Test\"},{\"originalName\":\"[All Analytic rules].EventIDEquals\"},{\"originalName\":\"[All Analytic rules].EventIDList\"},{\"originalName\":\"[All Analytic rules].test\"},{\"originalName\":\"[All Analytic rules].TableUsed\"},{\"originalName\":\"[All Analytic rules].LastModifiedOn\"}]}",
                    "size": 0,
                    "title": "All the analytic rules that use {TableName} table",
                    "noDataMessage": "Currently there are no rules which use this table",
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Table Name ",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Query",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "GenericDetails",
                            "linkLabel": "Click to open query and view additional information",
                            "linkIsContextBlade": true
                          }
                        },
                        {
                          "columnMatch": "Query Period",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Query Frequency",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "TemplateID",
                          "formatter": 5
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "Rule name",
                          "sortOrder": 1
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Enabled",
                          "label": "Status",
                          "comment": ""
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Rule name",
                        "sortOrder": 1
                      }
                    ]
                  },
                  "name": "RulesWithTable",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "EventID used in the scheduled analytic rules",
                    "expandable": true,
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "This view shows you when the EventID condition used in analytic rules. <br />\r\nIt can find `EventID ==` and `EventID in ()` <br />\r\n\r\n**Disclaimer**: <br />\r\n* It will only match on the first condition it and will not look for further matches. This means that SecurityEvent | where EventID == 1453 or EventID == 1698` will only match on the first condition. <br />\r\n* It will show the event even if your condition is excluding the event (e.g. `not( not ( where eventId== 1234))`)\r\n* If the event is not specified because it is part of a range, the event will not be matched (e.g. event 4625 will not be found if your query is checking for `EventID between (4624 .. 4627)`)\r\n\r\n**NOTE:** This information group is only visible when you are looking at rules that include the *SecurityEvent* table. <br />",
                          "style": "warning"
                        },
                        "name": "EventIDText"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRules\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-01-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s]?==[\\\\s]?[\\\"]?[']?([0-9]*)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"NotEventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s]?!=[\\\\s]?[\\\"]?[']?([0-9]*)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventIDList\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID in \\\\((([\\\"]?[']?[0-9]*[\\\"]?[,]?[\\\\s]?)*)\\\\)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventIDBetween\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID between \\\\([\\\\s]?([0-9]*[\\\\s]? \\\\.\\\\.[\\\\s]? [0-9]*)[\\\\s]?\\\\)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"MultipleEventID\",\"substringRegexMatch\":\"([\\\\s\\\\S]*?(?:EventID[\\\\s]?==)|(?:EventID[\\\\s]?!=)|(?:EventID in)|(?:EventID between)[\\\\s\\\\S]*?){2}\",\"substringReplace\":\"Multiple\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"substringRegexMatch\":\"[\\\\s\\\\S]*SecurityEvent[\\\\s\\\\S]*\",\"substringReplace\":\"SecurityEvent\"}]}}]}",
                          "size": 0,
                          "title": "EventIDs found in all the rules",
                          "noDataMessage": "No analytic rules are defined ",
                          "exportParameterName": "TestQ",
                          "exportToExcelOptions": "all",
                          "queryType": 12,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RuleName",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Enabled",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "success",
                                      "text": "Enabled"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "disabled",
                                      "text": "Disabled"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "0ch"
                                }
                              }
                            ],
                            "rowLimit": 512
                          },
                          "sortBy": [],
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong"
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "0",
                          "comparison": "isEqualTo",
                          "value": "0"
                        },
                        "name": "EventIDFoundTableIndependent"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"EventIDFoundTableIndependent\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"NameOfTable\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[EventIDFoundTableIndependent].RuleName\",\"mergedName\":\"Rule Name\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[EventIDFoundTableIndependent].Query\",\"mergedName\":\"Query\",\"fromId\":\"unknown\"},{\"originalName\":\"[EventIDFoundTableIndependent].EventID\",\"mergedName\":\"EventID with the equals comparison\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[EventIDFoundTableIndependent].NotEventID\",\"mergedName\":\"EventID with the not-equals comparison\",\"fromId\":\"unknown\"},{\"originalName\":\"[EventIDFoundTableIndependent].EventIDList\",\"mergedName\":\"EventIDList with the in-operator\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[EventIDFoundTableIndependent].EventIDBetween\",\"mergedName\":\"EventIDBetween\",\"fromId\":\"unknown\"},{\"originalName\":\"[EventIDFoundTableIndependent].MultipleEventID\",\"mergedName\":\"Multiple Event IDs used \",\"fromId\":\"unknown\"},{\"originalName\":\"[EventIDFoundTableIndependent].TableUsed\"}]}",
                          "size": 0,
                          "title": "EventIDs found in the rules",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "NameOfTable",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "CellDetails",
                                  "linkLabel": "Click to see the full query",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "EventID with the equals comparison",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "NaN",
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventID with the not-equals comparison",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "NaN",
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventIDList with the in-operator",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "^\\s*[[0-9]*[,]]*",
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventIDBetween",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "^\\s*[[0-9]*[\\s]*[\\.]{2}[\\s]*[0-9]*",
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Multiple Event IDs used ",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "Multiple .*",
                                      "representation": "2",
                                      "text": "Multiple conditions found on EventID. Please review the query."
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "EventIDList with the in-operator",
                                "label": "EventID with the in-operator"
                              },
                              {
                                "columnId": "EventIDBetween",
                                "label": "EventID with the between-operator"
                              }
                            ]
                          },
                          "sortBy": []
                        },
                        "name": "EventIDs "
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Specify an event ID in the search box below to find analytics rules that include the event ID. <br/>\r\nThis view shows you when the EventID condition used in the rule. It will look for queries that search for `\"EventID ==\"` and `\"EventID in ()\"` <br />\r\nPlease note: <br />\r\n* It will only match on the first condition it and will not look for further matches. This means that SecurityEvent | where EventID == 1453 or EventID == 1698` will only match on the first condition. <br />\r\n* It will show the event even if your condition is excluding the event (e.g. `not( not ( where eventId== 1234))`)\r\n* If the event is not specified because it is part of a range, the event will not be matched (e.g. event 4625 will not be found if your query is checking for `EventID between (4624 .. 4627)`)\r\n* For single digit events, please check the query to make sure the event is there. E.g. if you type number 2 or number 3, User32LogonProcess could show up as a result if another event ID was part of the query.\r\n\r\n**NOTE:** This information group is only visible when you are looking at rules that include the *SecurityEvent* table. <br />",
                          "style": "warning"
                        },
                        "name": "EventIDText - Copy"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "505d8786-c967-489f-8926-02d23c31c9fd",
                              "version": "KqlParameterItem/1.0",
                              "name": "SearchEventIDRules",
                              "label": "Search for eventID ",
                              "type": 1,
                              "description": "You can search all your rules to see if this EventID appears in the rules (one EventID only)",
                              "value": "3",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "SearchParameter - EventIDRules"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRules\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-01-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.query\",\"columnid\":\"SearchEventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s\\\\S]*?({SearchEventIDRules})[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"substringRegexMatch\":\"[\\\\s\\\\S]*SecurityEvent[\\\\s\\\\S]*\",\"substringReplace\":\"SecurityEvent\"}]}}]}",
                          "size": 0,
                          "title": "Search EventID: {SearchEventIDRules}",
                          "noDataMessage": "No analytic rules are defined ",
                          "exportToExcelOptions": "all",
                          "queryType": 12,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RuleName",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Enabled",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "success",
                                      "text": "Enabled"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "disabled",
                                      "text": "Disabled"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "0ch"
                                }
                              }
                            ],
                            "rowLimit": 512
                          },
                          "sortBy": [],
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong"
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "0",
                          "comparison": "isEqualTo",
                          "value": "0"
                        },
                        "name": "SearchEventIDRules"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"SearchEventIDRules\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[SearchEventIDRules].RuleName\",\"mergedName\":\"RuleName\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDRules].Query\",\"mergedName\":\"Query\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDRules].SearchEventID\",\"mergedName\":\"SearchEventID\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDRules].TableUsed\",\"mergedName\":\"TableUsed\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"}]}",
                          "size": 0,
                          "title": "EventID {SearchEventIDRules} found in the rules",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "CellDetails",
                                  "linkLabel": "Click to see the full query",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "SearchEventID",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "representation": "failed",
                                      "text": "Not found"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "Found {0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "TableUsed",
                                "formatter": 5
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_SearchEventID_2",
                                "sortOrder": 2
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "RuleName",
                                "label": "Rule Name"
                              },
                              {
                                "columnId": "SearchEventID",
                                "label": "Found the EventID"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_SearchEventID_2",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "name": "FoundEventIDRules"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "TableName",
                    "comparison": "isEqualTo",
                    "value": "SecurityEvent"
                  },
                  "name": "EventID",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "analytics"
            },
            "name": "Rules"
          },
          {
            "type": 1,
            "content": {
              "json": "This section shows information about templates available for the {TableName} table.\r\nThe templates you see below are available for you to create.\r\nYou can do this from Analytics > Rule templates. Then, select the rule you want to deploy and select *Create rule*. <br>\r\nBelow you can see two graphs. The first one shows how many analytics rules are enabled and disabled. In the second graph you can see the severity of all the analytic rules (both enabled and disabled)\r\n\r\n",
              "style": "info"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Help",
                "comparison": "isEqualTo",
                "value": "Yes"
              },
              {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "analytics"
              }
            ],
            "name": "Available templates explained"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Information about the templates with  {TableName} table",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRuleTemplates\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2021-10-01-preview\"},{\"key\":\"\",\"value\":\"\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.description\",\"columnid\":\"Description\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.tactics\",\"columnid\":\"Tactics\"},{\"path\":\"$.properties.severity\",\"columnid\":\"Severity\"},{\"path\":\"$.properties.queryPeriod\",\"columnid\":\"QueryPeriod\"},{\"path\":\"$.properties.queryFrequency\",\"columnid\":\"QueryFrequency\"},{\"path\":\"$.properties.status\",\"columnid\":\"Status\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*{TableName}[\\\\s\\\\S]*\",\"substringReplace\":\"{TableName}\"},{\"path\":\"$.properties.version\",\"columnid\":\"Version\"},{\"path\":\"$.properties.lastUpdatedDateUTC\",\"columnid\":\"LastModifiedOn\"},{\"path\":\"$.name\",\"columnid\":\"TemplateId\"},{\"path\":\"$.kind\",\"columnid\":\"AnalyticKind\"}]}}]}",
                    "size": 0,
                    "title": "All Analytic rule templates",
                    "noDataMessage": "No templates are defined ",
                    "exportParameterName": "TestQ",
                    "exportToExcelOptions": "all",
                    "queryType": 12,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "RuleName",
                          "formatter": 1
                        },
                        {
                          "columnMatch": "Description",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5,
                          "formatOptions": {
                            "customColumnWidthSetting": "0ch"
                          }
                        }
                      ],
                      "rowLimit": 512,
                      "labelSettings": [
                        {
                          "columnId": "RuleName",
                          "label": "Rule name"
                        }
                      ]
                    },
                    "sortBy": [],
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "0",
                    "comparison": "isEqualTo",
                    "value": "0"
                  },
                  "name": "All Analytic rules templates"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules templates\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[All Analytic rules templates].Status\",\"mergedName\":\"Status\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Static 1\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Status\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"1\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[All Analytic rules templates].Version\",\"mergedName\":\"Version\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].TemplateId\",\"mergedName\":\"TemplateId\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].AnalyticKind\",\"mergedName\":\"AnalyticKind\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].Version\",\"mergedName\":\"Version\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].TemplateId\",\"mergedName\":\"TemplateId\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].AnalyticKind\",\"mergedName\":\"AnalyticKind\",\"fromId\":\"unknown\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"},{\"originalName\":\"[All Analytic rules templates].RuleName\"},{\"originalName\":\"[All Analytic rules templates].Query\"},{\"originalName\":\"[All Analytic rules templates].Description\"},{\"originalName\":\"[All Analytic rules templates].Tactics\"},{\"originalName\":\"[All Analytic rules templates].Severity\"},{\"originalName\":\"[All Analytic rules templates].QueryPeriod\"},{\"originalName\":\"[All Analytic rules templates].QueryFrequency\"},{\"originalName\":\"[All Analytic rules templates].TableUsed\"}]}",
                          "size": 0,
                          "title": "{TableName}: Available vs Installed templates",
                          "noDataMessage": "Currently there are no rules which use this table",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "categoricalbar",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Table Name ",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Severity",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "GenericDetails",
                                  "linkLabel": "Click to open query and view additional information",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "Query Period",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query Frequency",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5
                              }
                            ],
                            "filter": true,
                            "labelSettings": [
                              {
                                "columnId": "Enabled",
                                "label": "Status",
                                "comment": ""
                              }
                            ]
                          },
                          "sortBy": [],
                          "chartSettings": {
                            "xAxis": "Status"
                          }
                        },
                        "customWidth": "25",
                        "name": "TemplatesWithTable - Chart - Available",
                        "styleSettings": {
                          "maxWidth": "25"
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules templates\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[All Analytic rules templates].Severity\",\"mergedName\":\"Severity\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[Added column]\",\"mergedName\":\"Added column\",\"fromId\":null,\"isNewItem\":true,\"newItemData\":[{\"criteriaContext\":{\"leftOperand\":\"Severity\",\"operator\":\"isNotNull\",\"rightValType\":\"column\",\"resultValType\":\"static\",\"resultVal\":\"1\"}},{\"criteriaContext\":{\"operator\":\"Default\",\"rightValType\":\"column\",\"resultValType\":\"column\"}}]},{\"originalName\":\"[All Analytic rules templates].Version\",\"mergedName\":\"Version\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].TemplateId\",\"mergedName\":\"TemplateId\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].AnalyticKind\",\"mergedName\":\"AnalyticKind\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].Version\",\"mergedName\":\"Version\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].LastModifiedOn\",\"mergedName\":\"LastModifiedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].TemplateId\",\"mergedName\":\"TemplateId\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].AnalyticKind\",\"mergedName\":\"AnalyticKind\",\"fromId\":\"unknown\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"},{\"originalName\":\"[All Analytic rules templates].RuleName\"},{\"originalName\":\"[All Analytic rules templates].Description\"},{\"originalName\":\"[All Analytic rules templates].Query\"},{\"originalName\":\"[All Analytic rules templates].Tactics\"},{\"originalName\":\"[All Analytic rules templates].QueryPeriod\"},{\"originalName\":\"[All Analytic rules templates].QueryFrequency\"},{\"originalName\":\"[All Analytic rules templates].Status\"},{\"originalName\":\"[All Analytic rules templates].TableUsed\"}]}",
                          "size": 0,
                          "title": "{TableName}: Severity of all the templates (available and installed)",
                          "noDataMessage": "Currently there are no rules which use this table",
                          "showRefreshButton": true,
                          "queryType": 7,
                          "visualization": "categoricalbar",
                          "gridSettings": {
                            "filter": true
                          },
                          "sortBy": [],
                          "tileSettings": {
                            "showBorder": false,
                            "titleContent": {
                              "columnMatch": "Table Name ",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "Static value 1",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "chartSettings": {
                            "xAxis": "Severity",
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Medium",
                                "color": "orange"
                              },
                              {
                                "seriesName": "High",
                                "color": "redBright"
                              },
                              {
                                "seriesName": "Low",
                                "color": "yellow"
                              }
                            ]
                          }
                        },
                        "customWidth": "25",
                        "name": "TemplatesWithTable - Severity - Chart",
                        "styleSettings": {
                          "maxWidth": "25"
                        }
                      }
                    ]
                  },
                  "name": "Charts for templates"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "This section contains all the analytic rule templates that query the {TableName} table. If you want to enable one of them, go to Analytics > Rule templates. Then, selected the template and select *Create*. Remember to visit the Content Hub to find new templates.\r\n",
                    "style": "info"
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Help",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "analytics"
                    }
                  ],
                  "name": "help"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Analytic rules templates\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"Table Name\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].RuleName\",\"mergedName\":\"Rule name\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].Description\",\"mergedName\":\"Description\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].Query\",\"mergedName\":\"Query\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].Tactics\",\"mergedName\":\"Tactics\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].Severity\",\"mergedName\":\"Severity\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].QueryPeriod\",\"mergedName\":\"Query Period\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].QueryFrequency\",\"mergedName\":\"Query Frequency\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Analytic rules templates].TemplateId\",\"mergedName\":\"TemplateId\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Analytic rules templates].TableUsed\"},{\"originalName\":\"[All Analytic rules templates].Status\"},{\"originalName\":\"[All Analytic rules templates].AnalyticKind\"},{\"originalName\":\"[All Analytic rules templates].LastModifiedOn\"},{\"originalName\":\"[All Analytic rules templates].Version\"}]}",
                    "size": 0,
                    "title": "All the analytic rule templates that use {TableName} table",
                    "noDataMessage": "Currently there are no templates which use this table",
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Table Name",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Installed?",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Installed",
                                "representation": "success",
                                "text": "Installed"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "more",
                                "text": "Available"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Query",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "GenericDetails",
                            "linkLabel": "Click to open query and view additional information",
                            "linkIsContextBlade": true
                          }
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Query Period",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Query Frequency",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "TemplateId",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "NameOfTable",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Table Name ",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        }
                      ],
                      "filter": true,
                      "sortBy": [
                        {
                          "itemKey": "Rule name",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Rule name",
                        "sortOrder": 1
                      }
                    ]
                  },
                  "name": "TemplateRulesWithTable",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "title": "EventID used in analytic rule templates",
                    "expandable": true,
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "This view shows you when the EventID condition used in analytic rule templates. <br />\r\nIt is able to look for \"EventID ==\" and \"EventID in ()\" <br />\r\n\r\n**Disclaimer**: <br />\r\n* It will only match on the first condition it and will not look for further matches. This means that SecurityEvent | where EventID == 1453 or EventID == 1698` will only match on the first condition. <br />\r\n* It will show the event even if your condition is excluding the event (e.g. `not( not ( where eventId== 1234))`)\r\n* If the event is not specified because it is part of a range, the event will not be matched (e.g. event 4625 will not be found if your query is checking for `EventID between (4624 .. 4627)`)\r\n\r\n**NOTE:** This information group is only visible when you are looking at rules that include the *SecurityEvent* table. <br />",
                          "style": "warning"
                        },
                        "name": "TemplateEventIDText"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRuleTemplates\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-01-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s]?==[\\\\s]?[\\\"]?[']?([0-9]*)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"NotEventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s]?!=[\\\\s]?[\\\"]?[']?([0-9]*)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventIDList\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID in \\\\((([\\\"]?[']?[0-9]*[\\\"]?[,]?[\\\\s]?)*)\\\\)[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"EventIDBetween\",\"columnType\":\"string\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID between \\\\([\\\\s]?([0-9]*[\\\\s]? \\\\.\\\\.[\\\\s]? [0-9]*)[\\\\s]?\\\\)[\\\\s\\\\S]*\"},{\"path\":\"$.properties.query\",\"columnid\":\"MultipleEventID\",\"substringRegexMatch\":\"([\\\\s\\\\S]*?(?:EventID[\\\\s]?==)|(?:EventID[\\\\s]?!=)|(?:EventID in)|(?:EventID between)[\\\\s\\\\S]*?){2}\",\"substringReplace\":\"Multiple\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"substringRegexMatch\":\"[\\\\s\\\\S]*SecurityEvent[\\\\s\\\\S]*\",\"substringReplace\":\"SecurityEvent\"}]}}]}",
                          "size": 0,
                          "title": "EventIDs found in all the templates",
                          "noDataMessage": "No template rules are defined ",
                          "exportParameterName": "TestQ",
                          "exportToExcelOptions": "all",
                          "queryType": 12,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RuleName",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Enabled",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "success",
                                      "text": "Enabled"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "disabled",
                                      "text": "Disabled"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "0ch"
                                }
                              }
                            ],
                            "rowLimit": 512
                          },
                          "sortBy": [],
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong"
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "0",
                          "comparison": "isEqualTo",
                          "value": "0"
                        },
                        "name": "TemplateEventIDFoundTableIndependent"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"TemplateEventIDFoundTableIndependent\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[EventIDFoundTableIndependent].Query\",\"mergedName\":\"Query\",\"fromId\":\"unknown\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"Table Name\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].RuleName\",\"mergedName\":\"Rule Name\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].Query\",\"mergedName\":\"Query\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].EventID\",\"mergedName\":\"EventID with the equals comparison\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].NotEventID\",\"mergedName\":\"EventID with the not-equals comparison\",\"fromId\":\"unknown\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].EventIDList\",\"mergedName\":\"EventIDList with the in-operator\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].EventIDBetween\",\"mergedName\":\"EventIDBetween\",\"fromId\":\"unknown\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].MultipleEventID\",\"mergedName\":\"MultipleEventID\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[TemplateEventIDFoundTableIndependent].TableUsed\"}]}",
                          "size": 0,
                          "title": "EventIDs found in the templates of rules",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Table Name",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "CellDetails",
                                  "linkLabel": "Click to see the full query",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "EventID with the equals comparison",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "NaN",
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventID with the not-equals comparison",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "NaN",
                                      "representation": "more",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventIDList with the in-operator",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "^\\s*[[0-9]*[,]]*",
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "EventIDBetween",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "^\\s*[[0-9]*[\\s]*[\\.]{2}[\\s]*[0-9]*",
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "MultipleEventID",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "regex",
                                      "thresholdValue": "Multiple .*",
                                      "representation": "2",
                                      "text": "Multiple conditions found on EventID. Please review the query."
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": ""
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "TableUsed",
                                "formatter": 5
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "EventIDList with the in-operator",
                                "label": "EventID with the in-operator"
                              },
                              {
                                "columnId": "EventIDBetween",
                                "label": "EventID with the between-operator"
                              }
                            ]
                          }
                        },
                        "showPin": false,
                        "name": "TemplateEventIDs "
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "Specify an event ID in the search box below to find analytics rules that include the event ID. <br/>\r\nThis view shows you when the EventID condition used in the rule. It will look for queries that search for `\"EventID ==\"` and `\"EventID in ()\"` <br />\r\nPlease note: <br />\r\n* It will only match on the first condition it and will not look for further matches. This means that SecurityEvent | where EventID == 1453 or EventID == 1698` will only match on the first condition. <br />\r\n* It will show the event even if your condition is excluding the event (e.g. `not( not ( where eventId== 1234))`)\r\n* If the event is not specified because it is part of a range, the event will not be matched (e.g. event 4625 will not be found if your query is checking for `EventID between (4624 .. 4627)`)\r\n* For single digit events, please check the query to make sure the event is there. E.g. if you type number 2 or number 3, User32LogonProcess could show up as a result if another event ID was part of the query.\r\n\r\n**NOTE:** This information group is only visible when you are looking at rules that include the *SecurityEvent* table. <br />",
                          "style": "warning"
                        },
                        "name": "EventIDText"
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "505d8786-c967-489f-8926-02d23c31c9fd",
                              "version": "KqlParameterItem/1.0",
                              "name": "SearchEventIDTemplate",
                              "label": "Search for eventID ",
                              "type": 1,
                              "description": "You can search all the templates to see if this EventID appears in the template (one EventID only)",
                              "value": "4663",
                              "timeContext": {
                                "durationMs": 86400000
                              }
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "SearchParameter - EventIDTemplates"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/alertRuleTemplates\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-01-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"RuleName\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.query\",\"columnid\":\"SearchEventID\",\"columnType\":\"long\",\"substringRegexMatch\":\"[\\\\s\\\\S]*?EventID[\\\\s\\\\S]*?({SearchEventIDTemplate})[\\\\s\\\\S]*\",\"substringReplace\":\"$1\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"substringRegexMatch\":\"[\\\\s\\\\S]*SecurityEvent[\\\\s\\\\S]*\",\"substringReplace\":\"SecurityEvent\"}]}}]}",
                          "size": 0,
                          "title": "Search EventID: {SearchEventIDTemplate}",
                          "noDataMessage": "No template rules are defined ",
                          "exportParameterName": "TestQ",
                          "exportToExcelOptions": "all",
                          "queryType": 12,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "RuleName",
                                "formatter": 1
                              },
                              {
                                "columnMatch": "Description",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Enabled",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "==",
                                      "thresholdValue": "true",
                                      "representation": "success",
                                      "text": "Enabled"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "disabled",
                                      "text": "Disabled"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "Tactics",
                                "formatter": 5,
                                "formatOptions": {
                                  "customColumnWidthSetting": "0ch"
                                }
                              }
                            ],
                            "rowLimit": 512
                          },
                          "sortBy": [],
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong"
                          }
                        },
                        "conditionalVisibility": {
                          "parameterName": "0",
                          "comparison": "isEqualTo",
                          "value": "0"
                        },
                        "name": "SearchEventIDTemplate"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"SearchEventIDTemplate\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[SearchEventIDTemplate].RuleName\",\"mergedName\":\"RuleName\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDTemplate].Query\",\"mergedName\":\"Query\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDTemplate].SearchEventID\",\"mergedName\":\"SearchEventID\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[SearchEventIDTemplate].TableUsed\",\"mergedName\":\"TableUsed\",\"fromId\":\"d3bfe37c-803a-4215-b587-8c8db14580b6\"},{\"originalName\":\"[CreationOfTableName].NameOfTable\"}]}",
                          "size": 0,
                          "title": "EventID {SearchEventIDTemplate} found in analytic rule templates",
                          "queryType": 7,
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Query",
                                "formatter": 7,
                                "formatOptions": {
                                  "linkTarget": "CellDetails",
                                  "linkLabel": "Click to see the full query",
                                  "linkIsContextBlade": true
                                }
                              },
                              {
                                "columnMatch": "SearchEventID",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "representation": "failed",
                                      "text": "Not found"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "success",
                                      "text": "Found {0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "TableUsed",
                                "formatter": 5
                              }
                            ],
                            "sortBy": [
                              {
                                "itemKey": "$gen_thresholds_SearchEventID_2",
                                "sortOrder": 2
                              }
                            ],
                            "labelSettings": [
                              {
                                "columnId": "RuleName",
                                "label": "Rule Name"
                              },
                              {
                                "columnId": "SearchEventID",
                                "label": "Found the EventID"
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "$gen_thresholds_SearchEventID_2",
                              "sortOrder": 2
                            }
                          ]
                        },
                        "name": "FoundEventIDTemplate"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "TableName",
                    "comparison": "isEqualTo",
                    "value": "SecurityEvent"
                  },
                  "name": "EventID - Template",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "analytics"
            },
            "name": "Templates"
          },
          {
            "type": 1,
            "content": {
              "json": "In this section you will find information about saved searches which include, among others, hunting queries and functions. Look at the Category column to check the search type.",
              "style": "info"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Help",
                "comparison": "isEqualTo",
                "value": "Yes"
              },
              {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "hunting"
              }
            ],
            "name": "Helpsearches"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Information about saved searches for  {TableName} table",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/savedSearches\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-08-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"DisplayName\"},{\"path\":\"$.properties.category\",\"columnid\":\"Category\"},{\"path\":\"$.properties.functionAlias\",\"columnid\":\"FunctionAlias\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"columnType\":\"string\",\"substringRegexMatch\":\"([\\\\s\\\\S]*){TableName}([\\\\s\\\\S]*)\",\"substringReplace\":\"{TableName}\"}]}}]}",
                    "size": 0,
                    "title": "All Saved searches",
                    "noDataMessage": "No analytic rules are defined ",
                    "exportToExcelOptions": "all",
                    "queryType": 12,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5,
                          "formatOptions": {
                            "customColumnWidthSetting": "0ch"
                          }
                        }
                      ],
                      "rowLimit": 512,
                      "labelSettings": [
                        {
                          "columnId": "DisplayName",
                          "label": "Display Name"
                        },
                        {
                          "columnId": "FunctionAlias",
                          "label": "Function Alias"
                        }
                      ]
                    },
                    "sortBy": [],
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "0",
                    "comparison": "isEqualTo",
                    "value": "0"
                  },
                  "name": "All Saved searches"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Saved searches\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"Name Of Table\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Saved searches].DisplayName\",\"mergedName\":\"Display Name\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Saved searches].Category\",\"mergedName\":\"Category\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Saved searches].FunctionAlias\",\"mergedName\":\"Function Alias\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Saved searches].Query\",\"mergedName\":\"Query\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e9371b2\"},{\"originalName\":\"[All Saved searches].TableUsed\"}]}",
                    "size": 0,
                    "title": "All the saved searches that use {TableName} table",
                    "noDataMessage": "Currently there are no saved searches which use this table",
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Query",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "GenericDetails",
                            "linkLabel": "Click to open query and view additional information",
                            "linkIsContextBlade": true
                          }
                        },
                        {
                          "columnMatch": "TableUsed",
                          "formatter": 5
                        }
                      ],
                      "filter": true
                    },
                    "sortBy": []
                  },
                  "name": "SavedSearchesWithTable",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"ARMEndpoint/1.0\",\"data\":null,\"headers\":[],\"method\":\"GET\",\"path\":\"/subscriptions/{Subscription:id}/resourceGroups/{InternalRG}/providers/Microsoft.OperationalInsights/workspaces/{Workspace:name}/providers/Microsoft.SecurityInsights/bookmarks\",\"urlParams\":[{\"key\":\"api-version\",\"value\":\"2020-01-01\"}],\"batchDisabled\":false,\"transformers\":[{\"type\":\"jsonpath\",\"settings\":{\"tablePath\":\"$.value\",\"columns\":[{\"path\":\"$.properties.displayName\",\"columnid\":\"DisplayName\"},{\"path\":\"$.properties.incidentInfo.title\",\"columnid\":\"Incident\"},{\"path\":\"$.properties.notes\",\"columnid\":\"Notes\"},{\"path\":\"$.properties.query\",\"columnid\":\"Query\"},{\"path\":\"$.properties.updatedBy\",\"columnid\":\"Updated\"},{\"path\":\"$.properties.labels\",\"columnid\":\"Labels\"},{\"path\":\"$.properties.created\",\"columnid\":\"CreatedOn\"},{\"path\":\"$.properties.query\",\"columnid\":\"TableUsed\",\"columnType\":\"string\",\"substringRegexMatch\":\"([\\\\s\\\\S]*){TableName}([\\\\s\\\\S]*)\",\"substringReplace\":\"{TableName}\"}]}}]}",
                    "size": 0,
                    "title": "All Bookmarks",
                    "noDataMessage": "No analytic rules are defined ",
                    "exportToExcelOptions": "all",
                    "queryType": 12,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Enabled",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "true",
                                "representation": "success",
                                "text": "Enabled"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "disabled",
                                "text": "Disabled"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Tactics",
                          "formatter": 5,
                          "formatOptions": {
                            "customColumnWidthSetting": "0ch"
                          }
                        }
                      ],
                      "rowLimit": 512,
                      "sortBy": [
                        {
                          "itemKey": "Notes",
                          "sortOrder": 2
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "DisplayName",
                          "label": "Bookmark Name"
                        },
                        {
                          "columnId": "Incident",
                          "label": "Related to incident"
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "Notes",
                        "sortOrder": 2
                      }
                    ],
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong"
                    }
                  },
                  "conditionalVisibility": {
                    "parameterName": "0",
                    "comparison": "isEqualTo",
                    "value": "0"
                  },
                  "name": "All Bookmarks"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Below you will find events that were bookmarked by Microsoft Sentinel users. Bookmarks can be attached as evidence to incidents as useful logs related to an investigation.",
                    "style": "info"
                  },
                  "conditionalVisibilities": [
                    {
                      "parameterName": "Help",
                      "comparison": "isEqualTo",
                      "value": "Yes"
                    },
                    {
                      "parameterName": "selectedTab",
                      "comparison": "isEqualTo",
                      "value": "hunting"
                    }
                  ],
                  "name": "Helpbookmarks"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "{\"version\":\"Merge/1.0\",\"merges\":[{\"id\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\",\"mergeType\":\"innerunique\",\"leftTable\":\"CreationOfTableName\",\"rightTable\":\"All Bookmarks\",\"leftColumn\":\"NameOfTable\",\"rightColumn\":\"TableUsed\"}],\"projectRename\":[{\"originalName\":\"[CreationOfTableName].NameOfTable\",\"mergedName\":\"Name Of Table\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\"},{\"originalName\":\"[All Bookmarks].DisplayName\",\"mergedName\":\"Bookmark Name\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\"},{\"originalName\":\"[All Bookmarks].Query\",\"mergedName\":\"Query\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\"},{\"originalName\":\"[All Bookmarks].CreatedOn\",\"mergedName\":\"CreatedOn\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Bookmarks].Updated\",\"mergedName\":\"Updated\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Bookmarks].Labels\",\"mergedName\":\"Labels\",\"fromId\":\"unknown\"},{\"originalName\":\"[All Bookmarks].Incident\",\"mergedName\":\"Related to incident\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\"},{\"originalName\":\"[All Bookmarks].Notes\",\"mergedName\":\"Notes\",\"fromId\":\"ba59820e-a7dc-4134-adc5-d3279e93727c\"},{\"originalName\":\"[TablesUsage].DataType\"},{\"originalName\":\"[All Bookmarks].test\"},{\"originalName\":\"[All Bookmarks].TableUsed\"}]}",
                    "size": 0,
                    "title": "All the bookmarks that use {TableName} table",
                    "noDataMessage": "Currently there are no bookmarks which use this table",
                    "queryType": 7,
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Query",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "GenericDetails",
                            "linkLabel": "Click to open query and view additional information",
                            "linkIsContextBlade": true
                          }
                        },
                        {
                          "columnMatch": "TableUsed",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Updated",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Labels",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "CreatedOn",
                          "formatter": 5
                        }
                      ]
                    }
                  },
                  "showPin": false,
                  "name": "BookmarksWithTable",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "hunting"
            },
            "name": "Saved searches"
          },
          {
            "type": 1,
            "content": {
              "json": "This section shows searches and queries that were performed against the {TableName} table. You will see the number of queries performed in the time range selected below.\r\nNote that searches can be performed from different places:\r\n- Microsoft Sentinel\r\n- AppInsights (Azure Monitor)\r\n- Logic apps and playbooks\r\n- Logs UI\r\n- Azure dashboards\r\n- AIP\r\n- Other: PowerShell, notebooks, etc.",
              "style": "info"
            },
            "conditionalVisibilities": [
              {
                "parameterName": "Help",
                "comparison": "isEqualTo",
                "value": "Yes"
              },
              {
                "parameterName": "selectedTab",
                "comparison": "isEqualTo",
                "value": "searches"
              }
            ],
            "name": "HelpSearches"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "Information about the searches for {TableName} table",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "97088d89-3500-4e3a-8337-8c8faf19e9f1",
                        "version": "KqlParameterItem/1.0",
                        "name": "queryTime",
                        "label": "Time range",
                        "type": 4,
                        "description": "Select the time for which you want to see details on the queries that were performed on your table",
                        "value": {
                          "durationMs": 2592000000
                        },
                        "typeSettings": {
                          "selectableValues": [
                            {
                              "durationMs": 86400000
                            },
                            {
                              "durationMs": 172800000
                            },
                            {
                              "durationMs": 259200000
                            },
                            {
                              "durationMs": 604800000
                            },
                            {
                              "durationMs": 1209600000
                            },
                            {
                              "durationMs": 2592000000
                            }
                          ],
                          "allowCustom": true
                        },
                        "timeContext": {
                          "durationMs": 86400000
                        }
                      }
                    ],
                    "style": "pills",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 3"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "The following section shows how many queries were performed against the selected table in the time range you selected above, and where they originated from.",
                    "style": "info"
                  },
                  "conditionalVisibility": {
                    "parameterName": "Help",
                    "comparison": "isEqualTo",
                    "value": "yes"
                  },
                  "name": "Queries help"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Rest=dynamic([\"ASC_Portal\",\"ASI_Portal\",\"Sentinel-Investigation-Queries\",\"Sentinel-analyticsManagement-customerQuery\", \"AppInsightsPortalExtension\",\"AzureMonitorLogsConnector\",\"AppAnalytics\",\"IbizaExtension\",\"AzureInformationProtection\"]);\r\nLAQueryLogs\r\n| where QueryText matches regex \"{TableName}.*\\\\|\"\r\n| summarize MSDefenderForCloud = countif(RequestClientApp == \"ASC_Portal\"), MicrosoftSentinel = countif(RequestClientApp == \"ASI_Portal\" or RequestClientApp == \"Sentinel-Investigation-Queries\" or RequestClientApp == \"Sentinel-analyticsManagement-customerQuery\"), AppInsights = countif(RequestClientApp == \"AppInsightsPortalExtension\"), LogicApps = countif(RequestClientApp == \"AzureMonitorLogsConnector\"), LogsUI = countif(RequestClientApp == \"AppAnalytics\"), AzureDashboard = countif(RequestClientApp == \"IbizaExtension\"), AIP = countif(RequestClientApp == \"AzureInformationProtection\"), Other = countif(RequestClientApp !in (Rest))",
                    "size": 0,
                    "title": "Queries performed in {TableName} by origin in the {queryTime:label}",
                    "timeContext": {
                      "durationMs": 2592000000
                    },
                    "timeContextFromParameter": "queryTime",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "unstackedbar",
                    "tileSettings": {
                      "showBorder": false
                    }
                  },
                  "name": "Queries performed"
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "selectedTab",
              "comparison": "isEqualTo",
              "value": "searches"
            },
            "name": "Searches"
          }
        ]
      },
      "name": "TablesRules"
    }
  ],
  "fallbackResourceIds": [],
  "fromTemplateId": "sentinel-LogSources&AnalyticRulesCoverage",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
